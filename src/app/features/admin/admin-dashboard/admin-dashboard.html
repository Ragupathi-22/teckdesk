<div class="space-y-6">
  <!-- Header -->
  <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6 gap-4">
    <div>
      <h2 class="text-2xl font-bold text-gray-800">Admin Dashboard</h2>
      <p class="text-gray-600">Overview of assets and tickets</p>
    </div>

    <div class="flex flex-wrap items-center gap-3">
      <!-- Company Dropdown -->
      <div class="flex items-center gap-2">
        <label for="company" class="text-sm text-gray-700 font-medium">Company:</label>
        <select id="company"
          class="px-3 py-2 border rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:outline-none text-sm"
          [ngModel]="selectedCompanyId" (change)="onSwitchCompany($event)">
          @for (company of companies; track $index) {
          <option [value]="company.id">{{ company.name }}</option>
          }
        </select>
      </div>

      <!-- Add Admin Button -->
      <button (click)="showAddAdminModal = true"
        class="bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 transition">
        + Add Admin
      </button>
    </div>
  </div>

  <!-- Stats Section -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- Asset Stats Container -->
    <div class="bg-white rounded-xl shadow-md p-4 hover:shadow-lg transition-shadow">
      <h3 class="text-lg font-semibold mb-4 text-gray-800">Asset Stats</h3>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="bg-gray-50 rounded-lg p-4 shadow-sm hover:shadow-md transition transform hover:-translate-y-1">
          <app-stat-card [title]="'Total Assets'" [value]="assetStats().total"
            [icon]="getStatConfig('Total Assets', 0, 'Total').icon"
            [colorClass]="getStatConfig('Total Assets', 0, 'Total').colorClass" />
        </div>

        <div class="bg-gray-50 rounded-lg p-4 shadow-sm hover:shadow-md transition transform hover:-translate-y-1">
          <app-stat-card [title]="'Assigned'" [value]="assetStats().assigned"
            [icon]="getStatConfig('Assigned', 0, 'Assigned').icon"
            [colorClass]="getStatConfig('Assigned', 0, 'Assigned').colorClass" />
        </div>

        <div class="bg-gray-50 rounded-lg p-4 shadow-sm hover:shadow-md transition transform hover:-translate-y-1">
          <app-stat-card [title]="'In Stock'" [value]="assetStats().inStock"
            [icon]="getStatConfig('In Stock', 0, 'In Stock').icon"
            [colorClass]="getStatConfig('In Stock', 0, 'In Stock').colorClass" />
        </div>

        <div class="bg-gray-50 rounded-lg p-4 shadow-sm hover:shadow-md transition transform hover:-translate-y-1">
          <app-stat-card [title]="'Under Repair'" [value]="assetStats().underRepair"
            [icon]="getStatConfig('Under Repair', 0, 'Under Repair').icon"
            [colorClass]="getStatConfig('Under Repair', 0, 'Under Repair').colorClass" />

        </div>
      </div>
    </div>

    <!-- Ticket Stats Container -->
    <div class="bg-white rounded-xl shadow-md p-4 hover:shadow-lg transition-shadow">
      <h3 class="text-lg font-semibold mb-4 text-gray-800">Ticket Stats</h3>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="bg-gray-50 rounded-lg p-4 shadow-sm hover:shadow-md transition transform hover:-translate-y-1">
          <app-stat-card [title]="'Open Tickets'" [value]="ticketStats().open"
            [icon]="getStatConfig('Open', 0, 'Open').icon" [colorClass]="getStatConfig('Open', 0, 'Open').colorClass" />
        </div>

        <div class="bg-gray-50 rounded-lg p-4 shadow-sm hover:shadow-md transition transform hover:-translate-y-1">
          <app-stat-card [title]="'In Progress'" [value]="ticketStats().inProgress"
            [icon]="getStatConfig('In Progress', 0, 'In Progress').icon"
            [colorClass]="getStatConfig('In Progress', 0, 'In Progress').colorClass" />
        </div>

        <div class="bg-gray-50 rounded-lg p-4 shadow-sm hover:shadow-md transition transform hover:-translate-y-1">
          <app-stat-card [title]="'Resolved'" [value]="ticketStats().resolved"
            [icon]="getStatConfig('Resolved', 0, 'Resolved').icon"
            [colorClass]="getStatConfig('Resolved', 0, 'Resolved').colorClass" />
        </div>

        <div class="bg-gray-50 rounded-lg p-4 shadow-sm hover:shadow-md transition transform hover:-translate-y-1">
          <app-stat-card [title]="'New Today'" [value]="ticketStats().newToday"
            [icon]="getStatConfig('New Today', 0, 'NewToday').icon"
            [colorClass]="getStatConfig('New Today', 0, 'New Today').colorClass" />
        </div>
      </div>
    </div>
  </div>

  <!-- Recent Assets & Tickets -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6">
    <!-- Recent Assets -->
    <div class="bg-white rounded-xl shadow-md p-4 hover:shadow-lg transition-shadow">
      <h3 class="text-lg font-semibold mb-4 text-gray-800">Recent Assets</h3>

      @if (recentAssets && recentAssets.length > 0) {
      <ul class="divide-y divide-gray-200">
        @for (asset of recentAssets; track $index) {
        <li class="py-3 flex justify-between items-center">
          <span class="text-sm text-gray-500">{{ asset.tag }}</span>
          <span class="font-medium text-gray-700">{{ asset.name }}</span>
          <span class="px-2 py-1 text-xs rounded-full" [ngStyle]="{
              'background-color': getAssetStatusColor(asset.status),
              'color': 'white'
            }">
            {{ asset.status }}
          </span>
        </li>
        }
      </ul>
      } @else {
      <div class="text-center text-gray-400 py-6 text-sm">
        No recent assets available</div>
      }
    </div>

    <!-- Recent Tickets -->
    <div class="bg-white rounded-xl shadow-md p-4 hover:shadow-lg transition-shadow">
      <h3 class="text-lg font-semibold mb-4 text-gray-800">Recent Tickets</h3>

      @if (recentTickets && recentTickets.length > 0) {
      <ul class="divide-y divide-gray-200">
        @for (ticket of recentTickets; track $index) {
        <li class="py-3 grid grid-cols-2 sm:grid-cols-4 gap-2 items-center text-sm">
          <span class="text-gray-500">{{ ticket.raisedByName }}</span>
          <span class="text-gray-700 truncate">{{ ticket.title }}</span>

          <!-- Status badge -->
          <span class="px-2 py-0.5 text-xs rounded-full text-center whitespace-nowrap w-fit" [ngStyle]="{
              'background-color': getTicketStatusColor(ticket.status),
              'color': 'white'
            }">
            {{ ticket.status }}
          </span>

          <!-- Date -->
          <span class="text-gray-400">
            {{ ticket.timestamp?.toDate() | date: 'dd MMM yyyy' }}
          </span>
        </li>
        }
      </ul>
      } @else {
      <div class="text-center text-gray-400 py-6 text-sm">
        No recent tickets found
      </div>
      }
    </div>


  </div>
</div>

@if (showAddAdminModal) {
<app-admin-register (close)="showAddAdminModal = false">
</app-admin-register>
}